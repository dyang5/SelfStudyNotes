\documentclass[11pt]{article}
\usepackage{styletemplate}
% \usepackage{header}

\begin{document}

\title{\LARGE \textbf{Math 356: Number Theory (Rutgers)}}
\date{Winter Break, 2023}
\author{\textsc{David Yang}}

\maketitle

\begin{abstract}
These notes arise from lecture videos of Math 356: Number Theory (Quadratic Forms), originally taught by 
Professor \href{https://sites.math.rutgers.edu/~alexk/}{Alex Kontorovich}, at Rutgers University. I am grateful
to Professor Kontorovich for releasing the \href{https://www.youtube.com/playlist?list=PLs6rMe3K87LEwc77iVba5AsAUPC1qVowy}{lecture videos} online. 
I am responsible for all faults in this document, mathematical or otherwise; any merits of the
material here should be credited to Professor Kontorovich and not to me.
Feel free to message me with any suggestions or corrections at \href{mailto:dyang5@swarthmore.edu}{dyang5@swarthmore.edu}.
\end{abstract}

\tableofcontents

\newpage

\section{Introduction to Fermat's Last Theorem}

\begin{theorem}[Fermat's Last Theorem, 1637]
There are no positive integers $x$, $y$, $z$ that satisfy \[x^n + y^n = z^n\]
for integer $n > 2$. \\

An equivalent formulation is the one discussed in lecture:
\[
    x^n + y^n = z^n
\] where $n > 2$ is an integer, has no non-trivial solutions $x$, $y$, and $z$ in $\Q, \Z$.
\end{theorem}

\begin{definition}[Diophantine Problem]
A \textbf{Diophantine problem} is a polynomial equation solved in $\Z$ and $\Q$. \\

\textit{Fermat's Last Theorem is an example of a Diophantine problem.}
\end{definition}

\textit{Historically, in 1993, Andrew Wiles published a proof of Fermat's Last Theorem. Later, Wiles and his student Richard Taylor rectified the 1993 proof and published
the first successful proof. For these efforts, Wiles won the 2016 Abel Prize and
the 2017 Copley Medal.} \\

With some extra background, we can prove Fermat's Last Theorem for $n = 4$.

\subsection{Parameterization of Pythagorean Triples}

\begin{theorem}[Primitive Pythagorean Triple Generation]
If $(x, y, z)$ is a \textbf{primitive} pythagorean triple\footnote{if $(x, y, z)$ is a primitive Pythagorean triple, then it follows that $x$, $y$, and $z$ are pairwise primtiive.    
} ($\nexists \, d$ such that $d \mid x$, $d\mid y$ and $d \mid z$), then $z$ is odd. Furthermore, assuming that
$x$ is odd and $y$ is even, then there exists coprime $r, s \in \Z$ with such that
\[ x = r^2 - s^2, \, y = 2rs, \, z = r^2 + s^2. \]
\end{theorem}

\begin{proof}[Proof Sketch (Theorem 3)]
Since $y$ is even, we can rewrite $y = 2y_1$ for some integer $y_1$. Since $(x, y, z)$ are a Pythagorean triple, it follows that
\( y^2 = z^2 - x^2 = (z-x)(z+x). \) Substituting and expanding, we get that 
\[
    4y_1^2 = (z-x)(z+x).
\] 
Since $x$, $z$ are both odd, we can rewrite $z-x = 2a$ and $z+x =2b$, so 
\[ y_1^2 = ab\] where $(a, b) = 1$. Consequently, $a$, $b$ must themselves be perfect squares. We conclude that $y_1=rs$, where $r^2 = a$, $s^2=b$, and so it follows that
$y = 2rs$ for coprime $r$, $s$. 
\end{proof}

\subsection{Pythagorean Varieties}

\begin{definition}[Variety]
A \textbf{variety} is a set of solutions to a system of polynomial equations.
\end{definition}

Consider the variety $\mathcal{V}: x^2 + y^2 - z^2$, which is a Pythagorean variety. Note that
$\mathcal{V}(\R)$ is a structure consisting of two cones which are reflections about the $z$-axis,
and $ \mathcal{V}(\Z)$, $\mathcal{V}(\Q)$ are subsets of $\mathcal{V} (\R)$.

\begin{lemma}
For every $\vec{v} \in \mathcal{V}(\Q)$, there exists a unique primitive $\vec{w} \in \mathcal{V}(\Z)_+^{0}$ with $\vec{w} \sim \vec{v}$, where
$\vec{u} \sim \vec{v} \iff \vec{u} = \lambda\vec{v}, \, \lambda \in \R \setminus \{ 0\}$.
\end{lemma}

Note that $\mathcal{V}(\R)_+ / \sim$ can be thought of as $S^1$; for a point
$(x, y, z) \in \mathcal{V} (\R)_+ \mapsto \left( \frac{x}{z}, \frac{y}{z}, 1 \right)$. Furthermore, $\mathcal{V}(\R) / \sim = S^1 \cup \{0\}.$ \\

Furthermore, note that another set of representatives of $\mathcal{V} (\Q)_+ / \sim$ is $S^1(\Q)$. This gives a notion for why Pythagorean triples are fundamental:
they parameterize rational points on the unit circle. Formally, 
\[
    \left( \frac{r}{u}, \frac{t}{u} \right) \in S^1(\Q) \iff (r, t, u) \in \mathcal{V} (\Z)_+^{0} 
\]

\subsection{Proof of Fermat's Last Theorem for $n=4$}

\textbf{Statement.} $x^4 + y^4 = z^4$ in $\Z$ implies $xyz = 0$. \\
\textbf{Stronger Statement.} $x^4 + y^4 = z^2$ in $\Z$ implies $xyz = 0$.
\begin{proof}
Suppose there is a solution to $x^4 + y^4 = z^2$ in $\Z$ with $xyz \neq 0$. Then $(x^2, y^2, z)$ is a Pythagorean triple. Furthermore, since we can scale Pythagorean triples by their GCD to get a primitive triple, we can assume that 
$(x^2, y^2, z) \in \mathcal{V}(\Z)_+^0$ is rather a primitive Pythagorean triple. By the Parameterization
of primitive Pythagorean triples, there exists coprime $r, s \in \Z$ such that 
\[
  x^2 = r^2 - s^2, \, y^2 = 2rs, \, z = r^2 + s^2.  
\]

Furthermore, since $x^2$ is odd and $y^2$ is even by assumption, $r$ and $s$ also have opposite parity. From the first equation, we know that 
\[
    x^2 + s^2 = r^2,
\] where $x$ is odd, forcing $s$ to be even, and $r$ to be odd. Once again, $(x, s, r)$ is a primitive Pythagorean triple, so there exists coprime $u$, $v \in \Z$ such that
\[ 
    x = u^2 - v^2, \, s = 2uv, \, r = u^2 + v^2 
\]
where $(r, s) = 1$. We also know that $y^2 = 2rs$ from our first primitive Pythagorean triple $(x^2, y^2, z)$. Since $y$ is even, we can express it as $y=2y_1$ for some $y_1 \in \Z$. 
Since $r = u^2 + v^2$, $s = 2uv$, and $y=2y_1$, we have that
\[
    4y_1^2 = 2(u^2 + v^2)(2uv)
\]
    
and so 
\[
    y_1^2 = uv(u^2 + v^2).    
\]

Note however that $(u, v) = 1$. Consequently, $u$, $v$, and $u^2 + v^2$ are three pairwise coprime numbers whose product is a perfect square. Thus, $u$, $v$, and $u^2 + v^2$ must themselves be a perfect square.
We now write 
\[
    u = a^2, \, v = b^2, \, u^2 + v^2 = c^2
\]

From the third equation, we have that $a^4 + b^4 = c^2$. \\

Note that if $xyz \neq 0$, then
\[ c \leq c^2 = u^2 + v^2 \leq (u^2 + v^2)^2 = r^2 < r^2 + s^2 = z. \]

Thus, we have found a smaller, in the sense that $c < z$, primitive solution to $x^4 + y^4 = z^2$ with $abc \neq 0$. \\

We can continue this process of finding primitive solutions until we arive at a trivial solution. Thus, by the principle of infinite descent\footnote{or Fermat's descent}, we conclude
that $x^4 + y^4 = z^2$ in $\Z$ implies $xyz = 0$. \end{proof}

\newpage

\section{Modular Arithmetic}

\textit{Note: Basic modular arithmetic notes skipped due to prior knowledge. Important theorems/results added for completeness.}

\begin{theorem}[Fermat's Little Theorem]
If $p$ is a prime with $p \nmid a$, 
\[
    a^{p-1} \equiv 1 \pmod p.
\]
\end{theorem}

\begin{proof}
Note that $\{ 1\cdot a, 2\cdot a, \dots, (p-1)\cdot a, p\cdot a\}$
is a complete residue system modulo $p$. It follows that
\[
    (1\cdot a)(2\cdot a) \dots ((p-1) \cdot a) \equiv 1\cdot 2\cdot 3 \dots (p-1) \pmod p.
\]

Simplifying, we have that
\[
    (p-1)! a^{p-1} \equiv (p-1) \pmod p.
\]

Equivalently, we have that $p \mid (p-1)! \left( a^{p-1} - 1 \right).$ Since $p \nmid (p-1)!$, it follows that $p \mid a^{p-1} - 1$, so
\[
    a^{p-1} \equiv 1 \pmod p.
\]
\end{proof}

\subsection{Linear Diophantine Equations (and Euclidean Algorithm)}
Let $S = \{  an + bm \mid n, m \in \Z \}$\dots
\begin{theorem}
$S = d\Z$, where $d = \mathrm{gcd}(n, m).$  
\end{theorem}

\begin{proof}
First, note that $S \subseteq d\Z$. If $d \mid n$ and $d \mid m$, then $d \mid an$ and $d \mid bm$, so $d \mid an + bm$. 
It remains to show that $an + bm = d$ has a solution. It is possible to find such a solution by reversing the steps of the Euclidean Algorithm using $n$ and $m$.
\end{proof}

\begin{theorem}[Euclidean Algorithm]
The \textbf{Euclidean Algorithm} can be used to find the GCD of two integers $n > m > 0$ as follows:
\begin{itemize}
    \item Apply the `division' algorithm to rewrite $n = m \cdot q_1 + r_1$, where $0 \leq r_1 < m$.\footnote{for reference, we can express $n$ as $r_{-1}$ and $m$ as $r_0$.}
    \item Continue this process, finding $q_j, r_j$ such that $r_{j-2} = r_{j-1} q_j + r_j$, with $0 \leq r_j < r_{j-1}$.
    \item Stop at some finite $J \leq m$ with $r_J = 0$.
\end{itemize}

It follows that $r_{J-1} = \mathrm{gcd}(n, m).$ 
\end{theorem}

\begin{proof}
First, let's show that $\mathrm{gcd}(n, m) \mid r_{J-1}.$ Note that if $l \mid n$ and $l \mid n$, $l \mid n - mq_1$, so $l \mid r_1$. Similarly, if 
$l \mid r_{j-2}$ and $l \mid r_{j-1}$, then $l \mid r_{j-2} - r_{j-1}q_j$, so $l \mid r_j$. Thus, it follows, that $l \mid r_{J-1},$ and so $\mathrm{gcd}(n, m) \mid r_{J-1}.$ \\

It remains to show that $r_{J-1} \mid \mathrm{gcd}(n, m)$. Note that
$r_{J-2} = r_{J-1}q_{J} + r_J$, and $r_J = 0$. It follows that $r_{J-1} \mid r_{J-2}$. Following our steps backwards, 
we will find that $r_{J-1} \mid r_j$ for all $j \in [-1, J-2].$ 
Recall that $r_0 = m$ and $r_{-1} = n$. Consequently, since $r_{J-1} \mid r_j$ for all $j$, we have that $r_{J-1} \mid n$ and $r_{J-1} \mid m$, so $r_{J-1} \mid \mathrm{gcd}(n, m).$ \\

Since $\mathrm{gcd}(n, m) \mid r_{J-1}$ and $r_{J-1} \mid \mathrm{gcd}(n, m)$, it follows that $r_{J-1} = \mathrm{gcd}(n, m)$, as desired. 
\end{proof}

\subsection{Connections to Algebra}
When we studied Linear Diophantine Equations, we looked at sets $S = \{ xn + ym \mid x, y \in \Z \}.$ Such a set $S$ is an example of an ideal.
\begin{definition}[Ideals]
An \textbf{ideal} of the ring $\Z$ satisfies
\begin{itemize}
    \item For $z \in S$, $rz \in S$ for all $r \in \Z$.
    \item For $z_1, z_2 \in S$, $z_1 \pm z_2 \in S$.
\end{itemize}
\end{definition} 

\begin{definition}
An ideal $S$ of the ring $\Z$ is \textbf{principal} if there exists $d \in \Z$ such that
\[ S = (d) = \{ d \cdot r \mid r \in \Z \} = d\Z. \]     
\end{definition}

\begin{theorem}
$\Z$ is a \textbf{Principal Ideal Domain} (every ideal is principal). \\

Equivalently, suppose that $S = (n_1, \dots, n_k)$ is an ideal. Then there exists $d \in \Z$ such that $S = (d)$.\footnote{in fact, $d = \mathrm{gcd}(n_1, \dots, n_k)$. }
\end{theorem}

\begin{proof}
Suppose that $S = (n_1, \dots, n_k).$ If $l \mid n_1, \dots, l \mid n_k$, then for all $z \in S, l \mid z$. 
Thus, $d = \mathrm{gcd}(n_1, \dots, n_k) \mid z$ for all $z \in S$, so $S \subseteq d\Z$. \\

It remains to show that $d = \mathrm{gcd}(n_1, \dots, n_k) \in S.$ Let $r$ be the smallest positive element in $S$. Clearly, $r\Z \subseteq S$. 
It follows, by the Euclidean Algorithm that $d \mid r$, so $d = r$. Thus, $d\Z \subseteq S$.
\end{proof}

\begin{definition}[(Loose Definitions of) Groups, Rings, and Fields]
A \textbf{group} is a set $S$ with an operation $+$, $0$, and inverses. \\

A \textbf{ring} is a set $S$ with operations $+, \times$ that supports addition, subtraction, and multiplication. \\

A \textbf{field} is a set $S$ with operations $+, \times$ that supports addition, subtraction, multiplication, and divison\footnote{for all $x \in S \setminus \{0\}$, $\exists \, y \in S$ with $xy = 1$.}
\end{definition}

\begin{theorem}
($\Z / n\Z, +, \times$) is a field if and only if $n$ is prime.
\end{theorem}

\begin{proof}
For prime $p$ and $a \not\equiv 0 \pmod p$, $a^{p-1} \equiv 1 \pmod p$ by Fermat's Little Theorem, so $a^{p-2} = \overline{a}$, the modular inverse of $a \pmod p.$ Consequently, we have
found an explicit inverse for each $a \not\equiv 0 \pmod p$. \\

On the other hand, suppose that $n$ is not prime and let $a \in \Z / n\Z$ with $a \not\equiv 0 \pmod n$ and $\mathrm{gcd}(a, n) > 1$. Then $ab + nm = 1$ has no solutions, so $ab \equiv 1 \pmod n$ has no solutions $b$.  
\end{proof}

\begin{definition}[Units]
Let $u$ be an element of a ring $R$. $u$ is a \textbf{unit} of $R$ if and only if there exists $v \in R$ such that $uv = 1$. \\

The units of $\Z / n\Z$, expressed as $(\Z / n\Z)^{\times}$, is
\[
    (\Z / n\Z)^{\times} = \{ a \pmod{n} \mid \exists \,b : ab = 1 \}.
\]
\end{definition}

\begin{exercise}
The Gaussian Integers $\Z[i] = \{ x + iy \mid x, y \in \Z \}$ form a ring. \\

Let $R = \text{linear polynomials} / \Z$ is not a ring (product of linear polynomials is quadratic).
\end{exercise}

\textit{Related Observation: If $R$ is a PID, then it is a UFD.} \\

Going back to the Gaussian integers, it turns out that we can apply the Euclidean Algorithm using the norms of the Gaussian Integers as part of the division algorithm.
On the other hand, note that to avoid the issue of gcd's being unit multiples of each other, we say that two Gaussian integers are coprime if the ideal generated by them is the entire ring.

\begin{lemma}[Division Algorithm for Gaussian Integers]
For all $n, m \neq 0$ in the Gaussian integers, there exists $q, r$ in Gaussian integers such that
\[
    n = qm + r \text{ and } 0 < \mathcal{N}(r) < \mathcal{N}(m)
\]

where $\mathcal{N}(x+iy) = |x+iy|^2 = x^2 + y^2$.
\end{lemma}

\begin{proof}
Consider
\[
    \frac{n}{m} = z = \frac{n \overline{m}}{\mathcal{N}(m)}.
\] 

There exists a nearby close point $q$ in $\Z[i]$ such that 
\[
    \left| q - \frac{n}{m} \right| \leq \frac{\sqrt{2}}{2}
\]

Multiplying both sides by $|m|$, it follows that
\[
    |mq - n| \leq |m|\frac{\sqrt{2}}{2}
\]

We define $-r = mq - n$, so that $r = n - mq$. It follows from the above equation that
\[
    \mathcal{N}(r) = |r|^2 \leq \frac{1}{2}|m|^2 = \frac{1}{2}\mathcal{N}(m) < \mathcal{N}(m).
\]
Thus, the division algorithm holds for Gaussian integers, as desired.
\end{proof}

We can also prove a number of simple division rules, using our knowledge of ideals and Linear Diophantine Equations\dots

\subsection{Division Rules}
\begin{theorem}\label{thm:rel_prime_div}
If $a \mid bc$ and $\mathrm{gcd}(a, b) = 1$, then $a \mid c$.     
\end{theorem}

\begin{proof}
The ideal $(a, b) = \Z$. Equivalently, the Euclidean Algorithm gives us a solution to $ax + by = 1$. Multiplying both sides of this equation by $c$,
we get that
\[
    acx + bcy = c.
\]

Since $a \mid bc$, $a \mid bcy$; furthermore, $a \mid acx$. Thus, $a$ divides the left hand side and so $a$ must also divide the right hand side, giving $a \mid c$.
\end{proof}

\begin{corollary}\label{cor:prime_div_rule}
If $p$ is a prime and $p \mid bc$, then $p \mid b$ or $p \mid c$.
\end{corollary}

\begin{proof}
This follows directly from \cref{thm:rel_prime_div}, with $a = p$ and $a = c$ for the two cases.
\end{proof}

\begin{definition}[Order]
The \textbf{order of $p$ in $a$}, $\mathrm{ord}_p(a)$, is
\[
    \mathrm{ord}_p(a) = \max \{ k \mid (p^k \mid a) \}.
\] 
\end{definition}

\begin{corollary}
If $p$ is a prime and $a, b \in \Z$, then 
\[
    \mathrm{ord}_p(ab) = \mathrm{ord}_p(a) + \mathrm{ord}_p(b).   
\]    
\end{corollary}

\begin{proof}
Let $\mathrm{ord}_p(a) = \alpha$, so that $p = p^\alpha a_1$, with $p \nmid a_1$. 
Similarly, let $\mathrm{ord}_p(b) = \beta$, so that $p = p^\beta b_1$, with $p \nmid b_1$. \\

Consider 
\[
    ab = \left(p^\alpha a_1\right) \left( p^\beta b_1 \right)  = p^{\alpha + \beta} a_1b_1.
\]

By the contrapositive of \cref{cor:prime_div_rule}, since $p \nmid a_1$ and $p \nmid b_1$, so $p \nmid a_1b_1$. Thus, 
\[
    \mathrm{ord}_p(ab) = \alpha + \beta = \mathrm{ord}_p(a) + \mathrm{ord}_p(b). \, \qedhere
\]
\end{proof}

\begin{theorem}[Fundamental Theorem of Arithmetic]
If $n$ is a nonzero integer, then there exists $\varepsilon(n) = 0$ or $-1$ such that
\[
    n = (-1)^{\varepsilon(n)} \prod_p p^{\mathrm{ord}_p(n)}
\]
and this decomposition is unique.
\end{theorem}

\begin{proof}
Assume for the sake of contradiction that $n$ has a second factorization
\[
    n = (-1)^{\varepsilon(n)} \prod_{p} p^{e_p}.
\]

Fix $p$, and apply $\mathrm{ord}_p$ to both sides. We have that
\begin{align*}
    \mathrm{ord}_p(n) &= \mathrm{ord}_p \left( (-1)^{\varepsilon(n)} \prod_{q} q^{e_q} \right) \\
    &= \mathrm{ord}_p \left( (-1)^{\varepsilon(n)} \right) + \sum_q \mathrm{ord}_p(q^{e_q}). 
\end{align*}

Since $\mathrm{ord}_p \left( (-1)^{\varepsilon(n)} \right) = 0$ and $\mathrm{ord}_p(q^{e_q}) = 0$ for $q \neq p$, it follows that
$\mathrm{ord}_p(n) = p^{e_p} = e_p$. \\

Thus, the second factorization must be the same as the first one, and so the decomposition is unique.
\end{proof}

Note that the Fundamental Theorem of Arithmetic does not hold in the ring $\Z[\sqrt{5}i]$. For example, in this ring,
\[
    6 = 2\cdot 3 = (1+\sqrt{5}i)(1-\sqrt{5}i).
\]

\subsection{Rings, Units, and Connections to Pythagorean Triples}

So where does the above proof fail for this ring? Note that $\mathrm{ord}_2(6) = 1$, $\mathrm{ord}_{1+\sqrt{5}(i)} = \mathrm{ord}_{1-\sqrt{5}(i)} = 0$,
and so the additive property of orders for ``relatively prime'' numbers in the integers does not hold for the ring $\Z[\sqrt{5}i]$. 

\begin{exercise}
The set of units of $\Z[i]$ are $\pm 1, \pm i$.
The set of units of $\Z[\sqrt{5}i]$ are $\pm 1$.
\end{exercise}
% Lecture 10

Thus far, we've studied the similarities between viewing Pythagorean triples as rational points on a circle. Similarly, we
studied the question of which numbers appear as the hypotenuses of triples.\footnote{numbers that are $3 \pmod 4$ cannot appear, due to the fact that squares are $0, 1 \pmod {4}$}
Note that this is also equivalent to finding possible norms of Gaussian integers; for example, circles centered at $(0, 0)$ with radius $\sqrt{n}$ for $n \equiv 3 \pmod 4$ pass through no lattice points.
In general, we may also want to study which $n$ arise as the values of a general binary quadratic form $Ax^2 + Bxy + Cy^2$.

\begin{definition}[Irreducible]
An element $r$ in the ring $R$ is irreducible if, for an element $b$ in $R$, 
\[
    b \mid r \text{ implies that } b \text { is a unit or an associate to } r.
\]
\end{definition}

\begin{definition}[Associates]
Two elements $r$ and $s$ in the ring $R$ are \textbf{associates} if there exists an element $u$ in the set of non-units of $R$, $R^{\times}$, such that
\[
    r = us.
\]
\end{definition}

\begin{definition}[Prime]
An element $r$ in the ring $R$ is \textbf{prime} if 
\[
    r \mid s \cdot t \text{ implies } r \mid s \text{ or } r \mid t.
\]
\end{definition}

\begin{remark} 
In $R = \Z[\sqrt{5}]$, $2$ is irreducible but is not prime. \\
\end{remark}

\begin{definition}[Integral Domain]
A ring $R$ is an \textbf{integral domain} if 
\[
    xy = 0 \text{ implies } x = 0 \text{ or } y = 0
\] 

or equivalently, if $R$ has no zero divisors.
\end{definition}
\begin{lemma}[Prime implies irreducible in integral domains]
A prime element is irreducible over an integral domain $R$.
\end{lemma}

\begin{proof}
Let $p$ be a prime element in $R$. Suppose that $s \mid p$. We want to show that $s$ is a unit or $s$ is an associate of $p$. \\

Since $s \mid p$, there exists some $k \in R$ such that $sk = p$. It follows that $p \mid sk$. Since $p$ is a prime, we know by definition that
$p \mid s$ or $p \mid k$. \\

In the former case, it follows that $s = lp$ and $p = sk$. Thus, $p = sk = (lp)k$, and so $p(lk - 1) = 0$. Since $p \neq 0$, it follows that $lk = 1$, meaning that
$k$ is a unit and $s$ is by definition an associate of $p$. The latter case follows similarly, but will yield the result that $s$ is a unit of $R$. \\

Thus, prime elements are irreducible over integral domains, as desired.
\end{proof}

\begin{lemma}
Let $R$ be a PID. Then an element of $R$ that is irreducible is also prime.
\end{lemma}

\begin{proof}
Let $r$ be an element of $R$ that is irreducible. Assume that $r \mid ab$, and $r \nmid a$. We want to show that $r \mid b$. \\

Consider the ideal $(r, a)$. Since $R$ is a PID, $(r, a) = (d)$, where $\mathrm{gcd}(r, a) = d$. Since $d \mid r$ and $r$ is irreducible,
we know that $d$ is an associate of $r$ or $d$ is a unit of $R$. \\

If $d$ is an associate of $r$, it follows that $d = r\cdot u$ for a unit $u$. Since $a \in (d)$, we 
must have that $d = r\cdot u \mid a$, meaning that $r \mid a$. However, by assumption, $r \nmid a$, so $d$ cannot be an associate of $r$. \\

It follows that $d$ is a unit of $R$, so $(r, a) = (d) = R$. Note that $(r \cdot b, a \cdot b) = (b)$. 
Furthermore, $(r \cdot b) \subset (r)$, and $(a \cdot b) \subset (r)$. It follows that $(r \cdot b, a \cdot b) \subset (r)$. Thus, $(b) \subset (r)$ and so $r \mid b$.
\end{proof}

\begin{exercise}
$R^{\times}$ is a group.    
\end{exercise}

\begin{remark}
If $R$ is a PID, then an element is irreducible if and only if it is prime.
\end{remark}

\subsection{Quadratic Residues and Nonresidues}

Recall that we studied the question of which numbers are represented as sums of squares. 
From our modular arithmetic section, we know that no prime $p \equiv 3 \pmod 4$ can be expressed as a sum of squares.

\begin{lemma}
Every prime $p \equiv 1 \pmod 4$ is a sum of two squares.
\end{lemma}

\begin{lemma}[Quadratic Residues modulo $p$]
Modulo any prime $p$, half of the numbers (excluding $0$) are quadratic residues. \\

Equivalently, the number of numbers $n \equiv \pmod p$ where
$n \neq 0$ and there exists some $x$ such that $x^2 \equiv n \pmod p$ is $\frac{p-1}{2}.$
\end{lemma}

\begin{proof}
Note that $(x)^2 \equiv (-x)^2 \pmod p$. It follows that there must be at most half the numbers among the squares. \\

Furthermore, note that if $x^2 \equiv y^2 \pmod p$, then $p \mid x^2 - y^2$, so $p \mid (x-y)(x+y)$. By \cref{cor:prime_div_rule}, it follows that
$p \mid x-y$ or $p \mid x+y$, meaning $x \equiv y \pmod p$ or $x \equiv -y \pmod p$. Thus, all squares in the first half are distinct and there are exactly
$\frac{p-1}{2}$ quadratic residues modulo $p$.
\end{proof}

\begin{remark}
$a^{\frac{p-1}{2}} = 1 \pmod p \iff a$ is a quadratic residue.
\end{remark}

We can now find a procedure to write a prime $p \equiv 1 \pmod 4$ as a sum of two squares.
\begin{itemize}
    \item Find quadratic non-residue $a$ modulo $p$.
    \item Let $z = a^{\frac{p-1}{4}} \pmod p.$ It follows that 
    \[
        z^2 = a^{\frac{p-1}{2}} \equiv -1 \pmod p,
    \]
    so $z^2 + 1 \equiv 0 \pmod p$, and $z^2 + 1 = pk$ in the integers.
    \item In $\Z[i]$, $z^2 + 1 = (z+i)(z-i)$, so $(z+i)(z-i) = pk.$
    \item To find the common factor, apply the Euclidean algorithm to $z+i$ and $p$ in $\Z[i]$.
\end{itemize}

Put more succinctly, this procedure has two steps:
\begin{itemize}
    \item Find quadratic non-residue $a$ modulo $p$.
    \item Let $z = a^{\frac{p-1}{4}} \pmod p.$ Find $\mathrm{gcd}(z+i, p)$ in $\Z[i]$. 
\end{itemize} 

\begin{eg}
Let $p = 17$. Then $a = 3$ is a quadratic non-residue modulo $p$, and $z = 3^{\frac{17-1}{4}} \pmod{17} = 13.$ Note that $13^2 + 1^2 = 170 = 17 \cdot 10.$ \\

We apply the Euclidean Algorithm to $13+i$ and $17$ in $\Z[i]$:
\begin{align*}
    17 = (13+i) \cdot 1 + (4-i)
    13+i = (4-i) \cdot (3+i) + 0
\end{align*}

so $\mathrm{gcd}(13+i, 17) = 4-i$. \\

Thus, $17 = (4+i)(4-i) = \boxed{4^2 + 1^2}.$
\end{eg}

\begin{eg}[Super Large Example, all calculations computed using WolframAlpha]
Take $p = 55, 497, 159, 953$. Let $a = 21, 345$ (randomly picked quadratic non-residue), so that $a^{\frac{p-1}{2}} \equiv -1 \pmod p$. \\

Let $z = a^{\frac{p-1}{4}} = 4,334,787,849.$ Since $\mathrm{gcd}(z+i, p) = 235,532 + 4673i$, we conclude that
\[
    p = 235,532^2 + 4,673^2.
\] 
\end{eg}

\subsection{Norm Forms (and Eisenstein Integers)}

\begin{definition}
For $\omega = e^{\frac{2\pi i}{3}},$ the ring $\Z[\omega]$ consists of the \textbf{Eisenstein Integers}:
\[
    \Z[\omega] = \{ a_0 + a_1 \omega \mid a_0, a_1 \in \Z \}.
\] 

Since $\omega$ satisfies $\omega^2 + \omega + 1 = 0$, $\omega^2 = -\omega - 1$, so $\Z[\omega] = \Z[x] / (x^2 + x + 1).$
\end{definition}

\begin{remark}
The Eisenstein integers form a triangular/``hexagonal'' lattice in the complex plane.
\end{remark}

\begin{exercise}
What is the ``norm form'' for $\Z[\omega]$? \\

Note that 
\[
    \mathcal{N}(a + b\omega) = (a+b\omega)(a+b \overline{\omega}) = a^2 - ab + b^2.
\]
\end{exercise}

\begin{definition}
A ring $R$ is a \textbf{Euclidean Domain} if there is a norm function $\mathcal{N}: R \setminus \{ 0 \} \mapsto \N$
such that for all $n, m$ in $R$ with $m \neq 0$, there exists $q, r$ in $R$ such that
\[
    n = mq + r
\]

with $\mathcal{N}(r) < \mathcal{N}(m).$
\end{definition}

\begin{remark}
The ring $R = \R[x]$ is a Euclidean domain, where the ``norm function'' is the degree of a polynomial.\footnote{we can define $\mathrm{degree}(0) = -\infty$.} \\

On the other hand, $R = \Z[\sqrt{-5}]$ is not a Euclidean domain, since the division algorithm does not work:    \begin{quote}
    if $q = \lfloor \frac{n}{m} \rfloor,$ then 
    \[
        |r|^2 = |n - mq|^2 = \left| \left( \frac{n}{m} - q \right) \right|^2 |m|^2.
    \]

    However, note that $\left| \left( \frac{n}{m} - q \right) \right|^2 < \frac{3}{2}$, and so we can't conclude that $\mathcal{N}(r) < \mathcal{N}(m)$.
    \end{quote}
\end{remark}

\begin{theorem}
If $R$ is a Euclidean domain, it is a principal ideal domain.
\end{theorem}

\begin{proof}
Let $\mathcal{I} $ be an ideal of $R$. Either $\mathcal{I} = (0)$, which is principal, or $\mathcal{I} $ contains some nonzero element $a$.
Consider the latter case. Let 
\[
    S = \{ \mathcal{N}(i) \colon i \in \mathcal{I} \setminus \{ 0 \}  \} \subseteq \N.
\]

Let $s$ be the least element of $S$ and let $d \in \mathcal{I}$ satisfy $\mathcal{N} (d) = s$. By definition, $(d) \subseteq \mathcal{I}$. 
We want to show that, in fact, $(d) = \mathcal{I}$. Suppose that there is some nonzero element $m \in \mathcal{I} \setminus (d).$ \\

By the Division Algorithm, there must exist some $q, r$ in $R$ such that $m = dq + r$, and since $m \notin (d)$, $r \neq 0$ and $\mathcal{N} (r) < \mathcal{N} (d)$, which
contradicts the fact that $d$ has the smallest norm in $S$. Thus, $R$ must be a principal ideal domain.
\end{proof}

\subsection{Reformulating with Ideals}
Let's revisit some of our definitions for units, associates, and irreducible elements of a ring $R$ in terms of the ideals.

\begin{definition}
    \hfill
    \vspace{-0.75cm}
    \begin{itemize}
        \item $a \mid b$ if and only if $(b) \subseteq (a)$.
        \item $a$ is an \textbf{associate} of $b$ if and only if $(a) = (b)$.
        \item $u$ is a \textbf{unit of $R$} if and only if $(u) = R$.
        \item $r$ is \textbf{irreducible in $R$} if $r = s \cdot t$ for $s, t$ in $R$ implies $s$ is a unit of $(s) = (r)$.
        \item $p$ is a \textbf{prime in $R$} if and only if for $a \cdot b \in (p)$, either $a \in (p)$ or $b \in (p)$.
        \item $a, b$ in $R$ are \textbf{coprime} for $R$ a PID if and only if $(a, b) = R$.
        \item $d$ is a \textbf{gcd of $a, b$ in $R$} if and only if $(a) \subseteq  (d)$ and $(b) \subseteq (d)$ and 
        if $(a) \subseteq (d^{\prime})$ and $b \subseteq (d^{\prime})$, then $(d^{\prime}) \subseteq (d)$.
    \end{itemize}
\end{definition}

\begin{lemma}
If $R$ is a PID, and $a$ and $b$ are two elements in $R$, then there exists a gcd $d$ of $a$ and $b$ such that $(a, b) = (d).$
\end{lemma}

\begin{proof}
Note that there is some $d$ such that $(d) = (a, b)$. It remains to show that $d$ is a gcd of $a$ and $b$. Note that $b \in (a, b) \subseteq (d)$. Thus, $b = d\cdot k$, and $d \mid b$. 
By similar logic, we know $d \mid a$. \\

Suppose that $d^{\prime}  \mid a$ and $d^{\prime} \mid b$. Then $a = d^{\prime} \cdot l$ and $b = d^{\prime} \cdot k$, so $a \in (d^{\prime})$ and $b \in (d^{\prime}).$
It follows that $(d) = (a, b) \subseteq (d^{\prime})$, so $d \in (d^{\prime}).$ Thus, $d = d^{\prime} \cdot r$ and $d^{\prime} \mid d$.
Thus, $d$ is the gcd of $a$ and $b$ as desired.
\end{proof}

\begin{exercise}
Is $x^2 + 1$ irreducible in $R = (\Z / 5)[x]$? How about in $R = (\Z / 7)[x]$?
\end{exercise}

\begin{answer}
$x^2 + 1$ is not irreducible in $(\Z / 5)[x]$, as 
\[
    (x+2)(x+3) = x^2 + 5x + 6 \equiv x^2 + 1 \pmod 5.
\]

Note that this is equivalent to the question of whether there exists a solution $x$ to $x^2 \equiv -1 \pmod 5$. 
In general, recall that $x^2 + y^2 \equiv 0 \pmod p$ has a solution if and only if $p \equiv 1 \pmod 4$ or $p=2$. \\

Thus, since $7 \equiv 3 \pmod 4$, $x^2 + 1$ is irreducible in $R = (\Z / 7)[x]$.
\end{answer}

\begin{definition}[Noetherian Ring]
A ring $R$ is \textbf{Noetherian}\footnote{named after Emily Noether} if 
\[
    \mathcal{I}_1 \subseteq \mathcal{I}_2 \subseteq  \dots
\]

is a chain of ideals, then the chain stops in finite time (there exists $N$ such that for all $n > N$, $I_N=I_n$).
\end{definition}

\begin{remark}
$\Z$ is Noetherian (which also follows from the theorem below, as $\Z$ is a PID.)
\end{remark}

\begin{theorem}
If $R$ is a PID, then it is Noetherian.
\end{theorem}

\begin{proof}
Let $\mathcal{I}_1 \subseteq \mathcal{I}_2 \subseteq  \dots$ be an increasing chain of ideals in $R$. Let
\[
    \mathcal{I} = \bigcup_{k=1}^{\infty} \mathcal{I}_k.
\]

$\mathcal{I}$ is an ideal, and since $R$ is a PID, it follows that $\mathcal{I} = (a)$ for some $a$. 
There must exist a $N$ such that $a \in \mathcal{I}_N$, so $(a) \subseteq \mathcal{I}_N$. 
Since for any $n > N$, $\mathcal{I}_n \subseteq \mathcal{I}_N$, and they can't add any additional elements to $\mathcal{I}_N$, all $\mathcal{I}_n = \mathcal{I}_N$. 
It follows that $R$ is Noetherian. 
\end{proof}

\begin{lemma}
If $R$ is Noetherian, then any element $r$ in $R$ is a finite product of irreducibles.
\end{lemma}

\begin{proof}
If $r$ is not irreducible, then there exists an element $r_1$ in $R$ such that $r_1 \mid r$, $r_1$ is not a unit, $(r_1) \neq (r)$, and $(r) \subset (r_1)$. \\

If $r_1$ is itself not irreducible, then there exists some $r_2$ such that $r_2 \mid r_1$, $r_2$ is not a unit, $(r_2) \neq (r_1)$, and $(r_1) \subset (r_2)$. \\

Continuing this process, we arrive at an increasing chain of ideals:
\[
    (r) \subsetneq (r_1) \subsetneq (r_2) \dots
\]

Since $R$ is Noetherian, this process cannot go on forever. Suppose that it stops at $r_j$; this means that $l_1 = r_j$ is an irreducible factor of $r$. \\

We can continue this process on $s_1$, where $r = l_1 \cdot s_1$; we will find that there exist some $l_2$, an irreducible factor of $s_1$ and consequently, of $r$. 
Consider $s_2$, where $s_1 = l_2 \cdot s_2$, and so on and so forth. We once again find an increasing chain of ideals:

\[
    (r) \subsetneq (s_1) \subsetneq (s_2) \subsetneq \dots
\]

Since $R$ is Noetherian, this chain must stabilize, giving us an irreducible element $s_J$. It follows that
\[
    r = l_1 \cdots l_J \cdot s_J,
\]

giving us a finite product of irreducible elements.
\end{proof}

\begin{lemma}
Let $R$ be a Noetherian ring. Given a prime element $p$ (equivalently, irreducible) in $R$ and an element $a$ in $R$, there exists some natural number $n$ such that 
$\mathrm{ord}_p(a) = n$. 
\end{lemma}

\begin{proof}
If $p \mid a$, then $a = pa_1$. If $p \mid a_1$, then $a_1 = pa_2$, and so on and so forth. We have an increasing chain of ideals
\[
    (a) \subseteq (a_1) \subseteq (a_2) \subseteq \dots
\]    

This process must stop, so there must be some $n$ such that $p^n \mid a$ and $p^{n+1} \nmid a$.
\end{proof}

\begin{lemma}
If $R$ is Noetherian and $p$ is prime in $R$, then 
\[
    \mathrm{ord}_p(a+b) = \mathrm{ord}_p(a) + \mathrm{ord}_p(b).   
\]
\end{lemma}

\begin{proof}
Same as for $\Z$.
\end{proof}


\begin{theorem}[Noetherian implies UFD]
Any element $r$ in a Noetherian ring $R$ is uniquely expressed as 
\[
    r = u \prod_p p^{e_{p}}
\]

where $u$ is a unit, $p$ is prime, and $e_p = \mathrm{ord}_p(r).$ 
\end{theorem}

\begin{remark}[Important Takeaway]
\textbf{Note that Euclidean Domain implies PID which implies Noetherian ring which implies UFD.} \\

Recall from earlier that $\Z[\sqrt{-5}]$ is not Euclidean; this also follows from the fact that it is not a UFD: 
\[
    6 = 2 \cdot 3 = (1+\sqrt{-5})(1-\sqrt{-5}).
\]
\end{remark}

\subsection{A Return to Norm Forms, for Eisenstein Integers}

Recall that earlier in the course, we wanted to know which $n$ could be expressed as a sum of squares: $n = x^2 + y^2$.
We answered this question by studying $\Z[i]$, since the quadratic form $Q(x, y) = x^2 + y^2$ is the norm form for $\Z[i]$. \\

In the Eisenstein integers $\Z[\omega]$, the norm form is $\mathcal{N}(x+\omega y) = x^2 - xy + y^2$.

\begin{exercise}
Which integers $n$ can be expressed as $n = x^2 - xy + y^2$, for integers $x$ and $y$?    
\end{exercise}

\begin{answer}
We see $n = Q(x, y) \in \{0, 1, 3, 4, 7, 9, 12, 13, \dots\}$, and no values that are $\equiv 2 \pmod 3$! 
Additionally, for every prime $p \equiv 1 \pmod{3}$, there exists $x, y$ such that $x^2 - xy + y^2 = p$ (i.e. all primes equivalent to 1 $\pmod 3$ are represented 
-- and the $x, y$ can be determined efficiently.)    
\end{answer}

\begin{proof}
Let $p$ be a prime equivalent to $1 \pmod 3$. Set $z = a^{\frac{p-1}{3}} \pmod{p}$, for $z \not\equiv 1 \pmod{p}$ (there will be $\frac{2(p-1)}{3}$ possible $z$).\\

It follows by Fermat's Little Theorem that $z^3 - 1 \equiv 0 \pmod p$, so $z^3 - 1 = pk$ for some $k \in \Z$.
Since $z^3 - 1$ factors completely into $(z-1)(z-\omega)(z-\overline{\omega})$ in $\Z[\omega]$, we know that
\[
    (z-1)(z-\omega)(z-\overline{\omega}) = pk
\]
in $\Z[\omega]$. Since $z \not\equiv 1 \pmod{p}$, we know that $z - 1 \mid k$. Say that $k = (z-1)l$. Then 
\[
    (z-\omega)(z-\overline{\omega}) = pl.
\]

Note that $p \nmid z-\omega$ and $p \nmid z-\overline{\omega}$.
\footnote{if $p \mid z-\omega$, then $z-\omega = (c+d\omega)p$, which will only be satisfied if $pd = -1$. A similar line of reasoning
can be used to show $p \nmid z-\overline{\omega}$.} Since $p \nmid z-\omega$ and $p \nmid z-\overline{\omega}$ but $p \mid (z-\omega)(z+\overline{\omega})$, $p$ is not prime. 
Suppose that $p = (x+y\omega)(x+y\overline{\omega}) = x^2 - xy + y^2$. It follows that the component $x + y\omega$ must divide at least one of $z-\omega$ or $z-\overline{\omega}$. \\

Take the greatest common divisor, of $p$ and $z - \omega$ in $\Z[\omega]$; if this is $a + b\omega$, it follows that
\[
    p = a^2 - ab + b^2
\]

for integers $a, b$.
\end{proof}

In the above proof, we actually find an algorithm to solve $p = \mathcal{N}(x+y\omega) = x^2 - xy + y^2$ for $p \equiv 1 \pmod 3$.
\begin{itemize}
    \item In $\Z /p$, find an $a$ such that $a^{\frac{p-1}{3}} \not\equiv 1$ and set $z = a^{\frac{p-1}{3}} \pmod p$.
    \item Find $\mathrm{gcd}_{\Z[\omega]}(p, z-\omega) = x+y\omega$. Then $x^2 - xy + y^2 = p$. 
\end{itemize}


\begin{eg}
Find integers $x, y$ for $p = 3571$ such that
\[
    3571 = x^2 - xy + y^2
\]

using the Eisenstein integers.
\end{eg}

\begin{answer}
We can check that $p = 3571$ is a prime equivalent to $1 \pmod 3$. For ease of reference, let's define $l = \frac{p-1}{3} = 1190$.
\begin{itemize}
    \item We can find an $a$ such that $a^l \not\equiv 1 \pmod p$: there are $2l$ such $a$, and one such $a$ is $a=2$, as
    \[
        2^{1190} \pmod{3571} = 3467 \neq 1.
    \]
    Now, let $z = 3467$. We know that $z^3 - 1 \equiv 0 \pmod p$. 
    \item We now find $\mathrm{gcd}_{\Z[\omega]}(3571, 3467-\omega):$
    \begin{align*}
        3571 &= (3467-\omega)(1) + (104 + \omega) \\
        3467 - \omega &= (104 + \omega)(33) + (35 - 34\omega) \\
        104 + \omega &= (35 - 34\omega)(2+\omega) + 0.
    \end{align*}
    Thus, $\mathrm{gcd}_{\Z[\omega]}(3571, 3467-\omega) = 35 - 34\omega$ and so $\mathcal{N}(35 - 34\omega) = 3571$ and
    \[
        \boxed{3571 = 35^2 + 34\cdot35 + 34^2}.
    \]
\end{itemize}
\end{answer}



\begin{remark}
    Furthermore, for general $n = p_1 \cdots p_k$, where each $p_j$ for $j$ from $1$ to $k$ is $\equiv 1 \pmod{3}$,
    we can simply find a representation of each $p_j$ and multiply the resulting Eisenstein integers to find the representation for $n$.    
\end{remark}

\begin{remark}
In general, the \textbf{discriminant} $B^2 - 4AC$ of a quadratic form $Ax^2 + Bxy + Cy^2$ will tell us about the values it takes:
\[
    \begin{dcases}
        \text{both positive and negative values} & \text{ if } B^2 - 4AC > 0 ;\\
        \text{only positive values} & \text{ if } B^2 - 4AC < 0  ;\\
    \end{dcases}
\]

Since the discriminant for $x^2 - xy + y^2$ is $-3$, we know our norm form for the Eisenstein integers only takes on positive values.
\end{remark}


\end{document}